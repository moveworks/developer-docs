---
accreditations:
- DEFAULT
description: A plugin that books time off in Workday.
design_pattern_id: 2
difficulty_level: INTERMEDIATE
fidelity: TEMPLATE
installation_asset_uuid: e3a12c85-4980-4a0d-908e-a5e29e2e3470
installation_link: https://my.moveworks.com/agent-studio/plugin-workspace/plugins?externalAssetId=e3a12c85-4980-4a0d-908e-a5e29e2e3470
name: Request Time Off
num_implementations: 2
purple_chat_link: https://developer.moveworks.com/creator-studio/developer-tools/purple-chat-builder/?workspace=%7B%22title%22%3A%22My+Workspace%22%2C%22botSettings%22%3A%7B%22name%22%3A%22%22%2C%22imageUrl%22%3A%22%22%7D%2C%22mocks%22%3A%5B%7B%22id%22%3A4571%2C%22title%22%3A%22New+Mock%22%2C%22transcript%22%3A%7B%22settings%22%3A%7B%22colorStyle%22%3A%22LIGHT%22%2C%22startTime%22%3A%2211%3A43+AM%22%2C%22defaultPerson%22%3A%22ALEX%22%2C%22editable%22%3Afalse%2C%22botName%22%3A%22%22%2C%22botImageUrl%22%3A%22%22%7D%2C%22messages%22%3A%5B%7B%22from%22%3A%22USER%22%2C%22text%22%3A%22%3Cp%3EI+need+to+take+time+off%2C+could+you+help+me+with+that%3F%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3E%E2%9C%85+Working+on+%3Cb%3ERequest+Time+Off%3Cbr%3E%3C%2Fb%3E%E2%8F%B3+Calling+Plugin+%3Cb%3ERequest+Time+Off%3C%2Fb%3E%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3ESounds+good%2C+here+are+your+time+off+plans+and+balances.+You+can+choose+to+book+time+off+for+any+of+the+plans.%3C%2Fp%3E%22%2C%22cards%22%3A%5B%7B%22title%22%3A%22%3Cp%3E1+%E2%80%93+Employee+Time+Off+%28USA%29%3A+60+hours%3C%2Fp%3E%22%7D%2C%7B%22title%22%3A%22%3Cp%3E2+%E2%80%93+Sick+Time+Off+%28USA%29%3A+20+hours%3Cbr%3E%3C%2Fp%3E%22%7D%2C%7B%22title%22%3A%22%3Cp%3E3+%E2%80%93+Wellness+Day+%28USA%29%3A+24+hours%3C%2Fp%3E%22%7D%2C%7B%22buttons%22%3A%5B%7B%22text%22%3A%22Book+Time+Off%22%2C%22style%22%3A%22PRIMARY%22%7D%2C%7B%22text%22%3A%22Got+it%2C+thanks%21%22%7D%5D%7D%5D%7D%2C%7B%22from%22%3A%22USER%22%2C%22text%22%3A%22%3Cp%3ELets+book+time+with+the+first+time+off+plan%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3E%E2%9C%85+Working+on+%3Cb%3Efirst+time+off+plan%3C%2Fb%3E%3Cbr%3E%E2%8F%B3+Calling+%3Cb%3ERequest+Time+Off%3C%2Fb%3E+with%3A%3Cbr%3E-+%3Cb%3Etime_off_plan_selection%3C%2Fb%3E%3A+Moveworks+Time+Off+Plan%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3ESounds+good%2C+when+would+you+like+to+take+time+off%3F%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22USER%22%2C%22text%22%3A%22%3Cp%3ELets+take+time+off+on+July+4%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3E%E2%9C%85+Working+on%3A+%5C%22day+after+tomorrow%5C%22%3Cbr%3E%E2%8F%B3+Calling+%3Cb%3ERequest+Time+Off%3C%2Fb%3E+with%3A%3Cbr%3E-+%3Cb%3Etime_off_plan_selection%3C%2Fb%3E%3A+Moveworks+Time+Off+Plan%3Cbr%3E-+%3Cb%3Estart_date%3C%2Fb%3E%3A+2024-07-31%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3EDo+you+want+to+proceed+with+taking+time+off+for+one+business+day+%288+hours%29.%3Cbr%3E%3Cbr%3EBy+selecting+no%2C+you+can+specify+the+%3Cb%3Eend+date%3C%2Fb%3E%2C+and+any+additional+%3Cb%3Ecomments%3C%2Fb%3E+to+take+time+off.%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22USER%22%2C%22text%22%3A%22%3Cp%3EYes%2C+one+day+sounds+good%21%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3E%E2%9C%85+Working+on%3A+%5C%22ready+for+day+off%21%5C%22%3Cbr%3E%E2%8F%B3+Calling+%3Cb%3ERequest+Time+Off%3C%2Fb%3E+with%3A%3Cbr%3E-+%3Cb%3Etime_off_plan_selection%3C%2Fb%3E%3A+Moveworks+Time+Off+Plan%3Cbr%3E-+%3Cb%3Estart_date%3C%2Fb%3E%3A+2024-07-31%3Cbr%3E-+%3Cb%3Eadditional_details%3C%2Fb%3E%3A+No%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3EI+have+submitted+your+time+off+request+to+your+manager+%F0%9F%8F%9D%3C%2Fp%3E%22%7D%5D%7D%7D%5D%7D
solution_tags:
- HR
- HR - Time & Absence
systems:
- workday
time_in_minutes: 60
video: https://youtu.be/NsqL1DRX2xE
---

# Take time off in Workday with your copilot üèùÔ∏è

Your employees deserve to take time off to recharge and stay productive. Requesting time off in Workday requires you to log in and navigate multiple screens.

This guide helps you build a conversational experience for easy time off requests for your employees. It ensures your managers and payroll teams have accurate records of time off requests.

Let's dive in!

**Prerequisites**:

1. Validate that your Workday instance uses the same work email as your IDAM.

2. Ensure that your Workday administrator has the necessary permissions to configure an API Client for Workday and provide access to Business Objects like **Worker Data**¬†and¬†**Time Off**¬† as part of domain security policies.

3. Follow the [Workday Connector guide](https://developer.moveworks.com/creator-studio/resources/connector?id=workday) to set up your Creator Studio Connector.


# Conversation design

[This purple chat mockup](https://developer.moveworks.com/creator-studio/developer-tools/purple-chat-builder/?workspace=%7B%22title%22%3A%22My+Workspace%22%2C%22botSettings%22%3A%7B%7D%2C%22mocks%22%3A%5B%7B%22id%22%3A6521%2C%22title%22%3A%22Mock+1%22%2C%22transcript%22%3A%7B%22settings%22%3A%7B%22colorStyle%22%3A%22LIGHT%22%2C%22startTime%22%3A%2211%3A43+AM%22%2C%22defaultPerson%22%3A%22ALEX%22%2C%22editable%22%3Atrue%7D%2C%22messages%22%3A%5B%7B%22from%22%3A%22USER%22%2C%22text%22%3A%22%3Cp%3EI+need+to+take+time+off%2C+could+you+help+me+with+that%3F%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3E%E2%9C%85+Working+on+%3Cb%3ERequest+Time+Off%3Cbr%3E%3C%2Fb%3E%E2%8F%B3+Calling+Plugin+%3Cb%3ERequest+Time+Off%3C%2Fb%3E%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3ESounds+good%2C+here+are+your+time+off+plans+and+balances.+You+can+choose+to+book+time+off+for+any+of+the+plans.%3C%2Fp%3E%22%2C%22cards%22%3A%5B%7B%22title%22%3A%22%3Cp%3E1+%E2%80%93+Employee+Time+Off+%28USA%29%3A+60+hours%3C%2Fp%3E%22%7D%2C%7B%22title%22%3A%22%3Cp%3E2+%E2%80%93+Sick+Time+Off+%28USA%29%3A+20+hours%3Cbr%3E%3C%2Fp%3E%22%7D%2C%7B%22title%22%3A%22%3Cp%3E3+%E2%80%93+Wellness+Day+%28USA%29%3A+24+hours%3C%2Fp%3E%22%7D%2C%7B%22buttons%22%3A%5B%7B%22text%22%3A%22Book+Time+Off%22%2C%22style%22%3A%22PRIMARY%22%7D%2C%7B%22text%22%3A%22Got+it%2C+thanks%21%22%7D%5D%7D%5D%7D%2C%7B%22from%22%3A%22USER%22%2C%22text%22%3A%22%3Cp%3ELets+book+time+with+the+first+time+off+plan%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3E%E2%9C%85+Working+on+%3Cb%3Efirst+time+off+plan%3C%2Fb%3E%3Cbr%3E%E2%8F%B3+Calling+%3Cb%3ERequest+Time+Off%3C%2Fb%3E+with%3A%3Cbr%3E-+%3Cb%3Etime_off_plan_selection%3C%2Fb%3E%3A+Moveworks+Time+Off+Plan%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3ESounds+good%2C+when+would+you+like+to+take+time+off%3F%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22USER%22%2C%22text%22%3A%22%3Cp%3ELets+take+time+off+on+July+4%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3E%E2%9C%85+Working+on%3A+%5C%22day+after+tomorrow%5C%22%3Cbr%3E%E2%8F%B3+Calling+%3Cb%3ERequest+Time+Off%3C%2Fb%3E+with%3A%3Cbr%3E-+%3Cb%3Etime_off_plan_selection%3C%2Fb%3E%3A+Moveworks+Time+Off+Plan%3Cbr%3E-+%3Cb%3Estart_date%3C%2Fb%3E%3A+2024-07-31%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3EDo+you+want+to+proceed+with+taking+time+off+for+one+business+day+%288+hours%29.%3Cbr%3E%3Cbr%3EBy+selecting+no%2C+you+can+specify+the+%3Cb%3Eend+date%3C%2Fb%3E%2C+and+any+additional+%3Cb%3Ecomments%3C%2Fb%3E+to+take+time+off.%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22USER%22%2C%22text%22%3A%22%3Cp%3EYes%2C+one+day+sounds+good%21%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3E%E2%9C%85+Working+on%3A+%5C%22ready+for+day+off%21%5C%22%3Cbr%3E%E2%8F%B3+Calling+%3Cb%3ERequest+Time+Off%3C%2Fb%3E+with%3A%3Cbr%3E-+%3Cb%3Etime_off_plan_selection%3C%2Fb%3E%3A+Moveworks+Time+Off+Plan%3Cbr%3E-+%3Cb%3Estart_date%3C%2Fb%3E%3A+2024-07-31%3Cbr%3E-+%3Cb%3Eadditional_details%3C%2Fb%3E%3A+No%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3EI+have+submitted+your+time+off+request+to+your+manager+%F0%9F%8F%9D%3C%2Fp%3E%22%7D%5D%7D%7D%5D%7D) shows the experience we are going to build.

## Discovery questions to customize your conversation design

1. Which groups of employees can book time off through Workday through this plugin? Is it all employees in a country? Specific teams? Or other groups?
    * Identifying the target employee group determines the launch rules for your plugin.

2. Do you want your employees to request time off on Workday or through your Moveworks copilot?
    * You can simplify the development of your plugin by linking your employees to Workday to request time off. However, employees would need to log into Workday to complete their request. See [example conversation design.](https://developer.moveworks.com/creator-studio/developer-tools/purple-chat-builder/?workspace=%7B%22title%22%3A%22My+Workspace%22%2C%22botSettings%22%3A%7B%7D%2C%22mocks%22%3A%5B%7B%22id%22%3A6521%2C%22title%22%3A%22Request+Time+Off%22%2C%22transcript%22%3A%7B%22settings%22%3A%7B%22colorStyle%22%3A%22LIGHT%22%2C%22startTime%22%3A%2211%3A43+AM%22%2C%22defaultPerson%22%3A%22GWEN%22%2C%22editable%22%3Atrue%7D%2C%22messages%22%3A%5B%7B%22from%22%3A%22USER%22%2C%22text%22%3A%22%3Cp%3EI+need+to+take+time+off%2C+could+you+help+me+with+that%3F%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3E%E2%9C%85+Working+on+%3Cb%3ERequest+Time+Off%3Cbr%3E%3C%2Fb%3E%E2%9C%85+Calling+Plugin+%3Cb%3ERequest+Time+Off%3Cbr%3E%3C%2Fb%3E%E2%8F%B3+Summarizing+response...%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22BOT%22%2C%22text%22%3A%22%3Cp%3ESounds+good%2C+you+are+eligible+for+three+time+off+plans%3A%3Cbr%3E1.+Employee+Time+Off+%28USA%29%3Cbr%3E2.+Sick+Time+Off+%28USA%29%3Cbr%3E3.+Wellness+Day+%28USA%29%3Cbr%3E%3Cbr%3EYou+can+request+time+off+through+this+%3Ca+href%3D%5C%22https%3A%2F%2Fworkday.com%5C%22%3Elink%3C%2Fa%3E+here.%3C%2Fp%3E%22%7D%2C%7B%22from%22%3A%22ANNOTATION%22%2C%22text%22%3A%22%3Cp%3E%3Ci%3ELink+redirects+to+Workday.+Employee+log+into+workday+to+request+time+off%3C%2Fi%3E%3C%2Fp%3E%22%7D%5D%7D%7D%5D%7D)

3. What are the required fields for managers to review time off requests (for example: comments and business justification)? Which are optional?
    * Required fields affect what questions will be asked of when they submit a time off request

4. Can your employees request time off requests only for themselves, or also for someone else?
   * Note: this guide only allows employees to request time off for themselves.
   * See API research below to understand how to customize API research to allow time off requests for other employees.

## Assumptions and caveats

1. The underlying Workday API will reject time off requests for plans where validations set in your Workday instances are not met. For example, if you have plans with inadequate balances or you're trying to submit a time off request on a holiday, the API would fail and the Bot would respond accordingly.

2. The `meta_info.user` attribute scopes the time off request to the employee making the request.
    * If you want to request time off on behalf of another employee, you can change this attribute to a slot that collects that employee's name and email address.

3. This guide does not notify employees when their time off request is approved through the bot.
    * To add notifications once time off requests are approved, please build a new plugin with the [Events API](https://developer.moveworks.com/creator-studio/quickstart/events/)

# For Workday administrators

## Overview of the configuration

We will be accessing Workday through:

* The read-only [Common API](https://community.workday.com/sites/default/files/file-hosting/restapi/#common/v1/get-/workers).
* The read + write [AbsenceManagement REST API](https://community.workday.com/sites/default/files/file-hosting/restapi/#absenceManagement/v1/workers).

This requires you to:

1. Integrate Workday with Creator Studio ‚Äì¬†by following [this guide](../../connectors/workday/README.md). After following this guide, you will have
    * An API Client for Workday
    * An Integration System User (ISU)
    * An Integration System Security Group (ISSG)
    * Relevant [domain security policies listed below](#domain-permissions-required) as part of your Integrations Security Systems Group (ISSG)
    * A User-Based Security Group
    * Relevant Business Processes adjusted to your User-Based Security Group

2. Set up relevant Business Processes

    * [Create a new User-Based Security Group](https://help.moveworks.com/docs/workday-access-requirements#set-up-a-user-based-security-group) by following the steps and assign your ISU to the group.
    * Use the `Edit Business Process Security Policy` task and select one of the [business processes listed below](#business-processes-to-edit).
        ![edit business process](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/edit%20business%20process.png)
    * Find the corresponding Initiating Action for the selected business process and add the User-Based Security Group you just created for this action.
        ![add group to business process](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/add%20group%20to%20business%20process.png)
    * Make sure to add the Security Group to all of the Business Process Types mentioned below.
    * Activate your security policy changes using the `Activate Pending Security Policy Changes` task
        ![activate policy](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/activate%20policy.png)

3. Share your Workday API credentials with your Moveworks developer team.

## Domain permissions required

| Operation       | Domain Security Policy                             | Functional Areas    |
| --------------- | -------------------------------------------------- | ------------------- |
| Get Only        | Worker Data: Workers                               | Staffing            |
| View and Modify | Worker Data: Time Off (Time Off)                   | Time Off and Leave  |
| View Only       | Worker Data: Time Off (Time Off Balances)          | Time Off and Leave  |
| Get and Put     | Worker Data: Time Off (Time Off)                   | Time Off and Leave  |
| Get Only        | Worker Data: Time Off (Time Off Balances)          | Time Off and Leave  |
| View Only       | Worker Data: Leave of Absence                      | Time Off and Leave  |
| Get Only        | Worker Data: Leave of Absence                      | Time Off and Leave  |
| View Only       | Worker Data: Public Worker Reports                 | Staffing            |
| Get Only        | Worker Data: Public Worker Reports                 | Staffing            |
| View and Modify | Business Process Reporting                         | System              |
| Get and Put     | Business Process Reporting                         | System              |
| View Only       | Indexed Data Source: Workers                       | Staffing            |
| View Only       | Worker Data: Staffing                              | Staffing            |
| Get Only        | Indexed Data Source: Workers                       | Staffing            |
| View Only       | Worker Data: Current Staffing Information          | Staffing            |
| Get Only        | Worker Data: Current Staffing Information          | Staffing            |
| View Only       | Person Data: Public Work Email Address Integration | Contact Information |
| Get Only        | Person Data: Public Work Email Address Integration | Contact Information |
| View Only       | Person Data: Work Contact Information              | Contact Information |
| Get Only        | Person Data: Work Contact Information              | Contact Information |

![Domain%20Permissions](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/domain%20perms.png)

## Business Processes to Edit

| Business Process Type | Initiating Action | Description |
| --- | --- | --- |
| Request Time Off | Request Time Off (REST Service) | Request time off for a worker using the public REST Service |
| Request Leave of Absence | Request Leave of Absence (REST Service) | Request leave of absence for a worker using the public REST Service |

**Inform your Creator Studio developer that they can now use your Workday credentials to build their connector and plugin**.


# For Creator Studio developers


## Step 1: Test required APIs

Copy the cURL commands below into your API client, like Postman or the Creator Studio Actions page, for testing. Substitute any `<PLACEHOLDER_TEXT>` or `{{placeholder_text}}` with relevant Workday API credentials or inputs. The ones with `{{}}` will be used as is while building the Actions since these will be your inputs from the user depending on their query.

We will use the following inputs for each API call below. You should to change these values based on your Workday instance and user you are testing with.

**API 1: Authentication**

Use the API below to generate a new access token for Workday. This access token is required for all subsequent API calls.

```bash
curl --location --request POST 'https://<DOMAIN>.workday.com/ccx/oauth2/<INSTANCE>/token' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--user '<CLIENT_ID>:<CLIENT_SECRET>' \
--data-urlencode 'grant_type=refresh_token' \
--data-urlencode 'refresh_token=<REFRESH_TOKEN>'
```

**API 2: Get worker ID for an employee given their name**

Use the API below to search for your user and their worker ID given their first name.

```bash
curl --location 'https://<DOMAIN>.workday.com/ccx/api/v1/<INSTANCE>/workers?search={{first_name}}' \
--header 'Authorization: Bearer <ACCESS_TOKEN>'
```

**API 3: Get eligible time off plan details for a specific worker ID**

Use the API below to get relevant time off plan details for an employee in Workday. 

```bash
curl --location 'https://<DOMAIN>.workday.com/ccx/api/absenceManagement/v1/<INSTANCE>/workers/{{worker_id}}/eligibleAbsenceTypes' \
--header 'Authorization: Bearer <ACCESS_TOKEN>'
```

**API 4: Request time off in Workday**

Use the API below to submit the time off request for a user in Workday. You must pass the following details from API 2 as part of the request:

1. `selected_date_n` - The date(s) you are requesting time off for, as a JSON array, where each date follows the `YYYY-MM-DD` format.
2. `timeOffType_id` - The `id` from API 2 which is the primary ID for each time off types inside the `data` attribute
3. The `dailyDefaultQuantity` from API 2 corresponding to each time off type.

```bash
curl --location 'https://<DOMAIN>.workday.com/ccx/api/absenceManagement/v1/<INSTANCE>/workers/{{worker_id}}/requestTimeOff' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer <ACCESS_TOKEN>' \
--data '{
  "days": [
    {
      "date": "{{selected_date_1}}",
      "dailyQuantity": {{dailyDefaultQuantity}},
      "comment": "User is taking time off through API",
      "timeOffType": {
        "id": "{{timeOffType_id}}"
      }
    },
    {
      "date": "{{selected_date_2}}",
      "dailyQuantity": {{dailyDefaultQuantity}},
      "comment": "User is taking time off through API",
      "timeOffType": {
        "id": "{{timeOffType_id}}"
      }
    },
    {
      "date": "{{selected_date_3}}",
      "dailyQuantity": {{dailyDefaultQuantity}},
      "comment": "User is taking time off through API",
      "timeOffType": {
        "id": "{{timeOffType_id}}"
      }
    }
  ]
}'
```


## Step 2: Build in Creator Studio - Agentic Automation Engine

Here, we will have to build 2 plugins using the Plugins workspace in Creator Studio to enable the following user journey:

![architecture](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/architecture.png)

The 2 separate plugins are required here since we are trying to provide a list of options to the user and we will need to take the selected options as the input for the next plugin.

### Creator Studio Components

- **Triggers**:
    1. Natural Language
- **Slots**:
    1. Time Off Date(s).
    2. Time Off Type.
    3. Comments (Optional).
- **Actions**:
    1. **Get worker details**:
        - Query the worker API to fetch an employees unique ID.
    2. **Retreive eligible Time Off types**:
        - Use the retrieved worker ID to fetch the eligible time off types for the employee.
    3. **Create Time Off Request**:
        - Use the slots and retreived details to submit a Time Off request for the employee.
- **Guidelines**:
    1. Plugin 2: Submit Time Off Request
        - Add a guideline to ensure that this plugin executes only when Plugin 1:Get Eligible Time Off Plans has executed and always ask the user for dates instead of making any assumptions.

### 1. Build HTTP Actions

- Define your HTTP Actions for submitting a time off request :
    1. **Get worker details**
        - In Creator Studio, create a new Action.
            - Navigate to¬†`Plugins`¬†section >¬†`Actions`¬†tab
            - Click on¬†`CREATE`¬†to define a new action

            ![Screenshot 2024-12-19 at 3.59.19‚ÄØPM.png](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/Screenshot%202024-12-19%20at%203.59.19‚ÄØPM.png)

        - Click on the `IMPORT CURL` option and paste the following cURL command:
            ```bash
            curl --location 'https://<DOMAIN>.workday.com/ccx/api/v1/<INSTANCE>/workers?search={{first_name}}' \
            --header 'Authorization: Bearer <ACCESS_TOKEN>'
            ```
        - Click on¬†`Use Existing Connector`¬†> select the¬†[**Workday**¬†**connector**](https://developer.moveworks.com/creator-studio/resources/connector/?id=jira) that you just created > Click on¬†`Apply`. This will populate the Base URL and the Authorization section of the API Editor.
        - **Input Variables** :
            - **first_name** : Example Value ( **John** ).
            
                ![action 1](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/action%201.png)
            
        - Click on¬†`Test`¬†to check if the Connector setup was successful and expect a successful response as shown below. You will see the request response on the left side and the generated output schema on the right. If the output schema does not match the API response or fails to populate automatically, kindly click the `GENERATE FROM RESPONSE` button to refresh and align the schema with the API response.
        
            ![action 1 result](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/action%201%20result.png)
        
        - Add the **API Name** and **API Description** accordingly and `Save` the action.
        
    2. **Retreive eligible Time Off types**
        - Repeat the steps above to create another action.
        - Click on the `IMPORT CURL` option and paste the following cURL command:

            ```bash
            curl --location 'https://<DOMAIN>.workday.com/ccx/api/absenceManagement/v1/<INSTANCE>/workers/{{worker_id}}/eligibleAbsenceTypes' \
            --header 'Authorization: Bearer <ACCESS_TOKEN>'
            ```

        - Use the existing connector by following the steps outlined in the previous point to populate the Base URL and Authorization section.
        - **Input Variables** :
            - **worker_id** : Example Value ( **01756f8736e1** )
            
                ![action 2](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/action%202.png)
            
        - Test the Connector setup as described earlier to verify the response. If the output schema is incorrect or missing, click `GENERATE FROM RESPONSE` to update it.
        
            ![action 2 result](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/action%202%20result.png)
        
        - Add the **API Name** and **API Description** accordingly and `Save` the action.

    3. **Create Time Off Request**
        - Repeat the steps above to create another action.
        - Click on the `IMPORT CURL` option and paste the following cURL command:

            ```bash
            curl --location 'https://<DOMAIN>.workday.com/ccx/api/absenceManagement/v1/<INSTANCE>/workers/{{worker_id}}/requestTimeOff' \
            --header 'Content-Type: application/json' \
            --header 'Authorization: Bearer <ACCESS_TOKEN>' \
            --data '{{{time_off_details}}}'
            ```

        - Use the existing connector by following the steps outlined in the previous point to populate the Base URL and Authorization section.
        - **Input Variables** :
            - **worker_id** : Example Value ( **01756f8736e1** )
            - **time_off_details** : Example Value ( `{   "days": [     {       "date": "2025-02-28T17:00:00.000Z",       "dailyQuantity": "8",       "timeOffType": {         "id": "4da2ece1ad9d100161c0ac66d1b20000"       }     },     {       "date": "2025-03-01T17:00:00.000Z",       "dailyQuantity": "8",       "timeOffType": {         "id": "4da2ece1ad9d100161c0ac66d1b20000"       }     },     {       "date": "2025-03-02T17:00:00.000Z",       "dailyQuantity": "8",       "timeOffType": {         "id": "4da2ece1ad9d100161c0ac66d1b20000"       }     }   ] }` )
                - We are providing the whole body of the payload as an input variable because we will be handling the creation of this whole JSON formatted body based on the date(s) selected while building the Compound Action script.
            
                ![action 3](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/action%203.png)
            
        - Test the Connector setup as described earlier to verify the response. If the output schema is incorrect or missing, click `GENERATE FROM RESPONSE` to update it.
        
            ![action 3 result](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/action%203%20result.png)
        
        - Add the **API Name** and **API Description** accordingly and `Save` the action.

### 2. Build Compound Action

- Build both of your compound actions for requesting a time off:
    1. **Compound Action 1: Get Eligible Time Off Plans**
        - Head over to the **Compound Actions** tab and click **CREATE**
            ![image 4.png](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/image_4.png)
        - Give your Compound Action a **Name** and **Description** , then click `Next`
            Note: Name only letters, numbers, and underscores. We suggest using snake case or camel case formatting (e.g. Workflow_name or workflowName )

        - Click on the `Script editor` tab. Here you will be able to build your compound action using the YAML syntax. At a high-level, this syntax provides actions (HTTP Request, APIthon Scripts) and workflow logic (switch statements, for each loops, return statements, parallel, try/catch). See the [Compound Action Syntax](https://developer.moveworks.com/creator-studio/reference/compound_actions_syntax/) Reference for more info.

            ```yaml
                steps:
                    - action:
                        action_name: workday_get_worker
                        input_args:
                            first_name: meta_info.user.first_name
                        output_key: workday_get_worker_result
                    - action:
                        action_name: workday_get_eligible_types
                        input_args:
                            worker_id: data.workday_get_worker_result.data.$FILTER(worker => worker.primaryWorkEmail == meta_info.user.email_addr)[0].id
                        output_key: workday_get_eligible_types_result
                    - return:
                        output_mapper:
                            instructions_for_model: '"You MUST ask the user which time off they would like to choose. Also let the user know if they can not submit time off through MoveworksBot they can use this link: <example link to redirect users>"'
                            workerWorkday_id: data.workday_get_worker_result.data.$FILTER(worker => worker.primaryWorkEmail == meta_info.user.email_addr)[0].id
                            list:
                                MAP():
                                    converter:
                                        dailyQuantity: item.dailyDefaultQuantity
                                        type: '"Eligible time off types"'
                                        timeOffType_Id: item.id
                                        descriptor: item.descriptor
                                    items: data.workday_get_eligible_types_result.data

            ```

    2. **Compound Action 2: Create Time Off Request**
        - Repeat the steps above to create another compound action.

        - Click on the `Script editor` tab to add the script.

            ```yaml
                steps:
                    - action:
                        action_name: workday_get_worker
                        input_args:
                            first_name: meta_info.user.first_name
                        output_key: workday_get_worker_result
                    - action:
                        action_name: workday_get_eligible_types
                        input_args:
                            worker_id: data.workday_get_worker_result.data.$FILTER(worker => worker.primaryWorkEmail == meta_info.user.email_addr)[0].id
                        output_key: workday_get_eligible_types_result
                    - action:
                        action_name: mw.generate_structured_value_action
                        input_args:
                            model: '"gpt-4o-mini"'
                            output_schema: >-
                            {
                                "type": "object",
                                "required": [
                                "submitted_time_off_dates"
                                ],
                                "properties": {
                                    "submitted_time_off_dates": {
                                        "type": "array",
                                        "items": {
                                            "type": "string",
                                            "pattern": "^\\d{4}-\\d{2}-\\d{2}T08:00:00\\.000Z$",
                                            "description": "Dates of submitted time off in the format YYYY-MM-DDT08:00:00.000Z."
                                        },
                                        "description": "An array of dates when time off has been submitted, each in the format YYYY-MM-DDT08:00:00.000Z."
                                    }
                                },
                                "additionalProperties": false
                            }
                            payload: data.time_off_dates
                        output_key: generate_structured_value_action_result
                    - action:
                        action_name: workday_create_time_off
                        input_args:
                            worker_id: data.workday_get_worker_result.data.$FILTER(worker => worker.primaryWorkEmail == meta_info.user.email_addr)[0].id
                            time_off_details:
                                EVAL():
                                    expression: '$STRINGIFY_JSON({"days": days})'
                                    args:
                                        days:
                                            MAP():
                                                converter:
                                                    comment: data.comment
                                                    dailyQuantity: data.workday_get_eligible_types_result.data.$FILTER(obj => obj.descriptor == data.time_off_type)[0].dailyDefaultQuantity
                                                    date: item
                                                    timeOffType:
                                                        id: data.workday_get_eligible_types_result.data.$FILTER(obj => obj.descriptor == data.time_off_type)[0].id
                                                items: $PARSE_JSON(data.generate_structured_value_action_result.openai_chat_completions_response.choices[0].message.content).submitted_time_off_dates
                        output_key: workday_create_time_off_result
                    - return:
                        output_mapper:
                            final_result: data.workday_create_time_off_result.days
                            instructions_for_model: '"Transform the provided JSON data into a streamlined
                            message for time off requests. Avoid repeating information except when
                            showing dates and hours. Include the requesters name. Keep the message
                            direct and end it after conveying the key information - no need for
                            calls to actions."'

            ```

    - Click on `Input fields` tab and click the `+Add` button. Here you will define the slots that you want to collect from users through the conversation and trigger your Workflow with. After defining the input fields, click the `Submit` button to save your changes.
        - **Name - Description - Example Value - Data Type**
        - time_off_dates - `Submitted array of time off dates in format: "Month name day year"` - `January 12 2025, March 3 2025, April 1 2025` - `string`
        - comment - `optional comment related to the time off requested. Use default if not provided: "n/a"` - `Raised time off request` - `string`
        - time_off_type - `Time off type related to the user's input provided upon execution of the previous plugin` - `Global PTO` - `string`
        ![compound action 2](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/compound%20action%202.png)

### 3: Publish Workflows to Plugin

- Head over to the `Compound Actions` tab and click on the kebab menu ( `Ô∏ô` ) for the **Compound Action 1: Get Eligible Time Off Plans** workflow
- Next, click on `Publish Workflow to Plugin`
- First, verify your Plugin's **Name** & **Short description** . This is autofilled from the name & description of your compound action.

  ![plugin 1](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/plugin%201.png)

- Next, consider whether to select the `User consent required before execution?` checkbox. Enabling this option prompts the user to confirm all slot values before executing the plugin, which is widely regarded as a best practice. Specifically for **Plugin 1: Get Eligible Time Off Plans**, user consent is not required since the conversation is proactively started by the user themself.

- Click `Next` and set up your positive and negative triggering examples. This ensures that the bot triggers your plugin given a relevant utterance.
    - See our [guide](https://developer.moveworks.com/creator-studio/conversation-design/triggers/natural-language-triggers/#how-to-write-good-triggering-examples) on Triggering
- Lastly, click `Next` and set the **Launch Rules** you want your plugin to abide by and `Submit` the plugin.
    - See our [guide](https://developer.moveworks.com/creator-studio/administration/launch-options/) on Launch Rules

- Repeat the above steps for **Compound Action 2: Create Time Off Request** as well.
- Make sure to follow the guideline to set the **Short description** in this case, because that will provide the Bot with the instruction to always execute **Plugin 1** before **Plugin 2:  Create Time Off Request**
    - **Short description**: `You MUST ALWAYS run the '<workday_get_eligible_time_off_plans>' plugin preceding this. You should always ask the user for the date(s) if not provided and do not assume current date.`
    - Replace `<workday_get_eligible_time_off_plans>` with the name of your Plugin 1.

    ![plugin 2](Plugin%20Template%20Request%20Time-Off%20in%20Workday%20081c4d522bf64bbead3697288dd46047/plugin%202.png)

## **Step 3: See it in action!**

- After both of the plugins are submitted, your use case will be published to the bot and triggerable based on your¬†**Launch Rules.**
- You should wait up to **5 minutes** after making changes before trying to test in your bot!
- If you run into an issue:
    1. Check our [troubleshooting guides](https://developer.moveworks.com/creator-studio/troubleshooting/support/)
    2. Understand your issue using Logs
    3. Reach out to Support


# Congratulations!

You just gave your employees the ability to take time off through your Copilot.¬†Look at our other Workday plugins below to further improve their experience and get inspired on what to build next.
